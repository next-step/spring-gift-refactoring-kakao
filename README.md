# spring-gift-refactoring

## [Step1] 구현할 기능 목록

이번 단계의 목표: 작동을 바꾸기 쉬운 상태를 만든다.
구조 변경을 통해 변경 난이도를 낮추되 작동은 유지한다.

### 1단계: 인수 테스트 작성

> 목적: 리팩토링 안전망을 구축한다. 기존 작동을 그대로 검증하는 테스트만 작성한다.
> 이 단계에서는 프로덕션 코드를 수정하지 않는다.

#### 1-1. 테스트 범위 결정
- [x] 각 Controller가 처리하는 API 엔드포인트 목록 분석
- [x] API 엔드포인트별 사용자가 관찰 가능한 시나리오 분석
  - 엔드포인트별 정상/실패 시나리오 도출
  - 실제 동작 기준으로 기대값 결정 (주석이 아닌 코드 실행 결과 기준)
- [x] 기존 테스트 커버리지 확인: 어떤 엔드포인트가 테스트되고, 어떤 것이 빠져있는가
- [x] 인수 테스트에 반영할 시나리오 선정

#### 1-2. 인수 테스트 작성

> 한 번에 모든 시나리오를 작성하면 안되며, 각 도메인별로 시나리오를 작성하고 테스트가 통과된 후 사용자의 검토를 받아야 한다.

- [x] 각 시나리오별 인수 테스트 작성
    - [x] 전체 테스트 실행 → 통과 확인
- [x] (시나리오별 반복)

---

### 2단계: 스타일 정리

> 목적: 프로젝트 전반의 스타일 불일치를 일관되게 정리한다.
> 이 단계에서는 로직을 변경하지 않는다. 포매팅만 변경한다.

- [ ] 스타일 포매터 선정
    - 대안 비교: IDE 기본 포매터 vs Checkstyle vs Spotless 등
- [ ] 포매터 적용 (네이밍, import, 공백, 줄바꿈, 중괄호 등)
- [ ] 전체 테스트 실행 → 통과 확인

---

### 3단계: 불필요한 코드 제거

> 목적: IDE 또는 정적 분석 도구가 "미사용"으로 표시하는 항목을 근거를 확인한 후 제거한다.
> 이 단계에서는 로직을 변경하지 않는다. 사용되지 않는 코드만 제거한다.

#### 3-1. 분석
- [ ] IDE/정적 분석 도구 실행하여 미사용 항목 목록 작성
- [ ] 주석-동작 불일치 지점 식별 (미사용 코드 주변의 주석이 현재 코드와 맞는지 확인)
    - 각 항목별: 주변 주석/TODO 확인, git blame 확인, 이후 단계 충돌 확인

#### 3-2. 제거

> 한 번에 모든 내용을 제거해서는 안되며, 각 도메인별로 작업한 후 사용자의 검토를 받아야 한다.

- [ ] 보고서에서 "삭제" 판정을 받은 항목만 제거
- [ ] 전체 테스트 실행 → 통과 확인

---

### 4단계: 서비스 계층 추출

> 목적: Controller의 비즈니스 로직을 Service로 이동한다.
> Controller는 요청 검증과 위임만 담당하도록 얇게 만든다.
> 이 단계에서는 신규 기능을 추가하지 않는다.

#### 4-1. 추출 계획
- [ ] Controller에 포함된 비즈니스 로직 식별
    - Controller별 엔드포인트, 현재 로직, 이동 대상, Controller에 남길 것
    - 대안 비교: 메서드 단위 추출 vs 도메인 단위 추출 등

#### 4-2. Controller별 추출

> 한 번에 모든 도메인에 대해 작업해서는 안되며, 각 도메인별로 작업한 후 사용자의 검토를 받아야 한다.

- [ ] Controller A → Service A 추출
    - [ ] Service 클래스 생성
    - [ ] Controller의 비즈니스 로직을 Service 메서드로 이동
    - [ ] Controller는 요청 검증 + Service 위임만 남김
    - [ ] 전체 테스트 실행 → 통과 확인
- [ ] (Controller별 반복)
