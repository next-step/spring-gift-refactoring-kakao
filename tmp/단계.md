# 전체 작업 단계

## 단계 1: 스타일 정리
- **목표**: 프로젝트 전반의 스타일 불일치를 통일 (작동 변경 없음)
- **변경 대상 파일**:
  - `auth/AuthenticationResolver.java`, `auth/JwtProvider.java`, `auth/TokenResponse.java` — @author/@since, @Autowired 제거
  - `member/AdminMemberController.java`, `member/MemberController.java`, `member/Member.java`, `member/MemberRequest.java`, `member/MemberRepository.java` — @author/@since, @Autowired, 필드 빈 줄 통일
  - `auth/KakaoAuthController.java`, `option/OptionController.java` — 블록 주석 스타일 통일
  - `option/OptionController.java` — `Collectors.toList()` → `.toList()`
- **검증 방법**: 전체 테스트 실행 (`./gradlew test`), ktlint
- **예상 리스크**: 없음 (순수 스타일 변경)
- **롤백 전략**: `git checkout -- .`

## 단계 2: 불필요한 코드 제거
- **목표**: 미사용 코드를 근거와 함께 제거 (작동 변경 없음)
- **변경 대상 파일**:
  - `order/OrderController.java` — 미사용 `wishRepository` 필드 및 import 제거
  - `option/OptionController.java` — `import java.util.stream.Collectors` 제거 (단계 1에서 `.toList()`로 전환 후)
- **검증 방법**: 전체 테스트 실행, 컴파일 확인
- **예상 리스크**: wishRepository가 주석의 "6. cleanup wish"에 대한 미구현 기능일 가능성 → git blame으로 확인 필요
- **롤백 전략**: `git checkout -- .`

## 단계 3: OrderService 추출
- **목표**: OrderController의 비즈니스 로직을 OrderService로 이동 (작동 변경 없음)
- **변경 대상 파일**:
  - 신규: `order/OrderService.java`
  - 수정: `order/OrderController.java`
  - 수정: `test/.../OrderControllerTest.java` (의존성 변경에 따른 조정)
- **이동 대상 로직**:
  - 옵션 검증 + 재고 차감
  - 포인트 차감
  - 주문 저장
  - 카카오 알림 전송
- **검증 방법**: 전체 테스트 실행
- **예상 리스크**: 트랜잭션 경계 변경 (Controller → Service) — `@Transactional` 필요 여부 확인
- **롤백 전략**: `git checkout -- .`

## 단계 4: MemberService 추출
- **목표**: MemberController의 회원가입/로그인 로직을 MemberService로 이동 (작동 변경 없음)
- **변경 대상 파일**:
  - 신규: `member/MemberService.java`
  - 수정: `member/MemberController.java`
- **이동 대상 로직**:
  - 이메일 중복 검사 + 회원 생성 + 토큰 발급 (register)
  - 이메일/비밀번호 검증 + 토큰 발급 (login)
- **검증 방법**: 전체 테스트 실행
- **예상 리스크**: 낮음
- **롤백 전략**: `git checkout -- .`

## 단계 5: KakaoAuthService 추출
- **목표**: KakaoAuthController의 OAuth 로직을 KakaoAuthService로 이동 (작동 변경 없음)
- **변경 대상 파일**:
  - 신규: `auth/KakaoAuthService.java`
  - 수정: `auth/KakaoAuthController.java`
- **이동 대상 로직**:
  - Kakao OAuth URL 생성 (login)
  - 토큰 교환 + 사용자 정보 조회 + 회원 등록/갱신 + JWT 발급 (callback)
- **검증 방법**: 전체 테스트 실행
- **예상 리스크**: 낮음
- **롤백 전략**: `git checkout -- .`

## 단계 6: OptionService 추출
- **목표**: OptionController의 비즈니스 로직을 OptionService로 이동 (작동 변경 없음)
- **변경 대상 파일**:
  - 신규: `option/OptionService.java`
  - 수정: `option/OptionController.java`
- **이동 대상 로직**:
  - 옵션명 검증 + 중복 검사 + 생성 (createOption)
  - 최소 옵션 수 제약 검사 + 삭제 (deleteOption)
- **검증 방법**: 전체 테스트 실행
- **예상 리스크**: 낮음
- **롤백 전략**: `git checkout -- .`

## 단계 7: WishService 추출
- **목표**: WishController의 비즈니스 로직을 WishService로 이동 (작동 변경 없음)
- **변경 대상 파일**:
  - 신규: `wish/WishService.java`
  - 수정: `wish/WishController.java`
- **이동 대상 로직**:
  - 위시 목록 조회 (getWishes)
  - 상품 검증 + 중복 검사 + 위시 추가 (addWish)
  - 위시 존재 검증 + 소유자 확인 + 삭제 (removeWish)
- **검증 방법**: 전체 테스트 실행
- **예상 리스크**: 낮음
- **롤백 전략**: `git checkout -- .`

## 단계 8: ProductService 추출
- **목표**: ProductController + AdminProductController의 공통 비즈니스 로직을 ProductService로 이동 (작동 변경 없음)
- **변경 대상 파일**:
  - 신규: `product/ProductService.java`
  - 수정: `product/ProductController.java`, `product/AdminProductController.java`
- **이동 대상 로직**:
  - 상품명 검증 + 카테고리 검증 + CRUD
- **검증 방법**: 전체 테스트 실행
- **예상 리스크**: API 컨트롤러와 Admin 컨트롤러 간 서비스 공유 범위 결정 필요
- **롤백 전략**: `git checkout -- .`

## 단계 9: AdminMemberController → MemberService 연결
- **목표**: AdminMemberController가 단계 4에서 만든 MemberService를 사용하도록 변경 (작동 변경 없음)
- **변경 대상 파일**:
  - 수정: `member/AdminMemberController.java`
  - 수정(필요 시): `member/MemberService.java`
- **이동 대상 로직**:
  - 이메일 중복 검사 + 회원 생성 (create)
  - 회원 조회/수정 (editForm, update)
  - 포인트 충전 (chargePoint)
- **검증 방법**: 전체 테스트 실행
- **예상 리스크**: 낮음
- **롤백 전략**: `git checkout -- .`

## 단계 10: CategoryService 추출
- **목표**: CategoryController의 로직을 CategoryService로 이동 (작동 변경 없음, 일관성 목적)
- **변경 대상 파일**:
  - 신규: `category/CategoryService.java`
  - 수정: `category/CategoryController.java`
- **검증 방법**: 전체 테스트 실행
- **예상 리스크**: 없음 (단순 CRUD)
- **롤백 전략**: `git checkout -- .`

## 단계 11: 최종 검증
- **목표**: 전체 리팩터링 결과 점검
- **검증 항목**:
  - 전체 테스트 통과
  - 모든 Controller가 Service에 위임하는 구조인지 확인
  - 불필요한 코드/import 잔여 여부 확인
  - README 체크리스트 최종 갱신
